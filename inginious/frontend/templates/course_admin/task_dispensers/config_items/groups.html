{# This file is part of INGInious. See the LICENSE and the COPYRIGHTS files for #}
{# more information about the licensing of this file. #}

{% set group_submission = course.get_task_dispenser().get_group_submission(taskid) %}
{%if short %}
    {{_("Submission mode")}} :
    <span class="group_submission group_submission-true" {% if not group_submission %} style="display: none;" {% endif %}>{{ _("Per group") }}</span>
    <span class="group_submission group_submission-false" {% if group_submission %} style="display: none;" {% endif %}>{{ _("Individually") }}</span>
{% else %}
<div class="mt-3">{{_("Submission mode")}}</div>
<div class="form-group {%if not taskid %} grouped-actions-{% endif %}group_submissions">
    <div class="row">
        <div class="col-md-12">
            <label>
            <input type="radio" value="false" name="group_submission_{{taskid}}" {%if taskid %} id="{{taskid}}" {% endif %} class="group_submission"
                {{ 'checked="checked"'|safe if not group_submission }}/>
            {{ _("Individually") }}
            </label>
        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            <label>
                <input type="radio" value="true" name="group_submission_{{taskid}}" {%if taskid %} id="{{taskid}}" {% endif %} class="group_submission"
                    {{ 'checked="checked"'|safe if group_submission }} />
                {{_("Per group")}}
            </label>
        </div>
    </div>
</div>

{%if taskid %}
<script>
    $("#edit_{{taskid}} .group_submissions input").change(function () {
        $("#task_{{taskid}} span.group_submission").hide();
        if($(this).val() == "true")
            $("#task_{{taskid}} .group_submission-true").show();
        else
            $("#task_{{taskid}} .group_submission-false").show();
    });
</script>
{% else %}
<script>
    $(".grouped-actions-group_submissions input").change(function () {
        let value =  $(this).val();
        $(".grouped-actions-task:checked").each(function () {
            $(".group_submissions #" + $(this).data("taskid") + "[value=" + value + "]").prop("checked", true).change();
        });
    });
</script>
{% endif %}

{% endif %}
